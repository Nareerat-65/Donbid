<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href='https://fonts.googleapis.com/css?family=Kanit&subset=thai,latin' rel='stylesheet' type='text/css'>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <title>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Kanit', sans-serif;
      background: #FAF5E6;
      color: #333;
    }

    header {
      background: #fcf7e9;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap; /* ‡πÉ‡∏´‡πâ‡∏¢‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
    }

    .navbar {
      background-color: #ffb948;
      display: flex;
      align-items: center;
      flex-wrap: wrap; /* ‡πÉ‡∏´‡πâ‡∏¢‡πà‡∏≠ */
      justify-content: space-between;
      width: 100%;
    }

    .buy-btn.disabled {
      pointer-events: none;
      background-color: gray;
      opacity: 0.6;
      cursor: not-allowed;
    }

    .navbar .logo {
      height: 175px;
      width: auto;
      margin: 0 20px;
    }

    .main {
      width: 90%;
      max-width: 1500px;
      display: flex;
      gap: 20px;
      padding: 20px;
      align-items: center;
      margin: 40px auto 0 auto;
    }

    .sidebar {
      width: 200px;
      background: #f2f2f2;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      border-radius: 10px;
      height: fit-content;
      align-self: flex-start;
      margin-top: 2%;
      /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ */
    }

    .hamburger {
      display: none;
      /* Desktop ‡πÑ‡∏°‡πà‡πÇ‡∏ä‡∏ß‡πå */
    }

    .sidebar button {
      padding: 12px;
      background: #ffa500;
      color: rgb(255, 255, 255);
      border: none;
      cursor: pointer;
      border-radius: 5px;
      font-size: 16px;
    }

    .sidebar button:hover {
      background: #e65100;
    }

    .content-area {
      flex: 1;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      align-items: stretch;

      width: 100%;
    }

    .content-area h2 {
      text-align: center;
      margin-bottom: 16px;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
    }

    .profile-container {
      max-width: 700px;
      margin: 0 auto;
      border-radius: 20px;
      padding: 32px 24px;
      text-align: center;
    }

    .profile-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ffeec7 60%, #ccc 100%);
      margin: auto;
      border: 4px solid #fffbe6;
    }

    .profile-name {
      margin-top: 16px;
      font-size: 22px;
      font-weight: bold;
      color: #009688;
    }

    .profile-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 32px;
    }

    .profile-box {
      padding: 16px;
      background: #f9f9f9;
      border-radius: 8px;
      font-size: 16px;
      color: #333;
    }

    /* ---------- ‡∏õ‡∏∏‡πà‡∏° ---------- */
    #logout-btn,
    #change-role {
      margin-top: 20px;
      padding: 12px 24px;
      background: linear-gradient(90deg, #ffa500 60%, #ff6f00 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      font-size: 16px;
    }

    #logout-btn:hover {
      background: linear-gradient(90deg, #e53935 60%, #c62828 100%);
    }

    #change-role:hover {
      background: linear-gradient(90deg, #009688 60%, #26a69a 100%);
    }

    .profile-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-width: 700px; /* üîπ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏à‡∏≤‡∏Å 500 ‚Üí 700 */
      width: 90%;
      margin: 20px auto;
      padding: 20px;
      border-radius: 16px;
    }

    .profile-form input,
    .profile-form select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }

    .save-btn {
      width: 50%;
      background-color: #ffa500;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 10px;
      cursor: pointer;
      margin: 20px auto;
      font-size: 1rem;
    }

    .save-btn:hover {
      background-color: #e65100;
    }

    #addressStatus {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
    }


    .product-card {
      display: flex;
      align-items: flex-start;
      gap: 16px;
      /* ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏Å‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î */
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 12px;
      margin: 12px auto;
      margin-bottom: 12px;
      background-color: #fff;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      width: 80%;
      /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏° parent */
      max-width: 800px;
    }

    .product-img {
      width: 200px;
      height: 210px;
      object-fit: cover;
      border-radius: 6px;
      flex-shrink: 0;
      /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏π‡∏õ‡∏¢‡πà‡∏≠‡∏à‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ */
    }

    .product-details {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .product-details h3 {
      margin: 0 0 6px 0;
      font-size: 1.2em;
    }

    .product-details p {
      margin: 4px 0;
    }

    .product-details small {
      color: #666;
    }

    /* ----- Modal ----- */
    .modal {
      display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
      position: fixed;
      z-index: 1000;
      left: 0; 
      top: 0;
      width: 100%; 
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏°‡∏∑‡∏î */
    }

    .modal-content {
      background: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 400px;
      max-width: 90%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      font-size: 16px;
    }

    .modal-header {
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
      color: #009688;
    }

    .modal-close {
      float: right;
      font-size: 20px;
      cursor: pointer;
      color: #888;
    }

    .modal-close:hover {
      color: #e53935;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á */
    .product-details button {
      width: 150px;           /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà */
      height: 40px;           /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà */
      padding: 0;
      padding: 10px 18px;
      background: #ffa500 ; 
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 8px;
    }

    .product-details button:hover {
      background: #e65100;
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }



    /* ---------- Responsive ---------- */
    @media (max-width: 768px) {
      .main {
        flex-direction: column;
        align-items: center;
      }

      .hamburger {
        display: block;
        /* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÇ‡∏ä‡∏ß‡πå‡∏õ‡∏∏‡πà‡∏° */
        background: #009688;
        color: white;
        border: none;
        padding: 12px 16px;
        font-size: 18px;
        cursor: pointer;
        border-radius: 5px;
        margin: 10px 0;
        width: 100%;
      }

      .sidebar {
        display: none;
        /* ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ã‡πà‡∏≠‡∏ô */
        width: 100%;
        flex-direction: column;
        gap: 5px;
        margin-bottom: 15px;
      }

      .sidebar.active {
        display: flex;
        /* ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° */
      }

      .profile-container {
        max-width: 95vw;
      }

      .profile-grid {
        grid-template-columns: 1fr;
        gap: 10px;
      }

      #logout-btn,
      #change-role {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <nav name="navbar" class="navbar">
        <div>
            <a href="../content/main-and-login.html" class="logo-link">
                <img src="../pic/Logo2.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ" class="logo">
            </a>
        </div>
    </nav>

  <div class="main">
    <button class="hamburger" id="hamburgerBtn">‚ò∞ ‡πÄ‡∏°‡∏ô‡∏π</button>

    <div class="sidebar" id="sidebarMenu">
      <div class="balance">üí∞ Coin: <span id="balance">0.00</span>
        <button onclick="location.href='/purchaseCoins/purchaseCoins.html'">
          +
        </button>
      </div>
      <button data-page="profile">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
      <button data-page="address">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</button>
      <button data-page="myProducts">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
      
    </div>

    <div class="content-area" id="contentArea">
      <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏î -->
    </div>

  </div>
  <!-- Modal -->
    <div id="deliveryModal" class="modal">
      <div class="modal-content">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <div class="modal-header">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div>
        <p><b>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö:</b> <span id="modalName"></span></p>
        <p><b>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</b> <span id="modalPhone"></span></p>
        <p><b>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</b> <span id="modalAddress"></span></p>
      </div>
    </div>


  <script>
    function showAlertError(title, message, icon = "error") {
      Swal.fire({
        icon: icon,
        title: title,
        text: message,
        confirmButtonColor: "#3085d6",
        confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
      });
    }
    function showAlert(title, message, icon = "success") {
        Swal.fire({
            icon: icon,
            title: title,
            text: message,
            confirmButtonColor: "#3085d6",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
        });
    }

    function renderProfile(payload) {
      const content = document.getElementById("contentArea");
      content.innerHTML = `
        <div class="profile-container">
          <div class="profile-avatar"></div>
          <div class="profile-name" id="username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</div>
          <div class="profile-grid">
            <div class="profile-box">ID: <span id="userId">-</span></div>
            <div class="profile-box">‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó: <span id="role">-</span></div>
            <div class="profile-box">Email: <span id="email">-</span></div>
            <div class="profile-box">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <span id="status">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span></div>
          </div>

          <button id="logout-btn">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          <button id="change-role">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</button>
        </div>
      `;

      // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
      document.getElementById('username').textContent = payload.username || '-';
      document.getElementById('userId').textContent = payload.id || '-';
      document.getElementById('role').textContent = payload.role || '-';
      document.getElementById('email').textContent = payload.email || '-';

      // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
      const avatarDiv = document.querySelector('.profile-avatar');
      avatarDiv.innerHTML = '';
      let profileImgUrl = '../pic/personal-icon.png';
      if (payload && payload.profile_img) {
        profileImgUrl = payload.profile_img;
      }
      const img = document.createElement('img');
      img.src = profileImgUrl;
      img.style.width = '100%';
      img.style.height = '100%';
      img.style.objectFit = 'cover';
      img.style.borderRadius = '50%';
      avatarDiv.appendChild(img);

      // ‡∏õ‡∏∏‡πà‡∏° logout
      document.getElementById('logout-btn').onclick = () => {
        localStorage.removeItem('token');
        window.location.href = '/login/login.html';
      };

      // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô role
      const changeRoleBtn = document.getElementById('change-role');
      if (payload.role === 'seller') {
        changeRoleBtn.style.display = 'none';
      }
      changeRoleBtn.onclick = async () => {
        const token = localStorage.getItem('token');
        const res = await fetch('/api/auth/user/upgrade-role', {
          method: 'POST',
          headers: { 'Authorization': 'Bearer ' + token }
        });
        const result = await res.json();
        if (res.ok && result.token) {
          localStorage.setItem('token', result.token);
          showAlert("‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", result.message);
          location.reload();
        } else {
          showAlertError("‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", result.error || result.message || '‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }
      };
    }

    // parse jwt
    function parseJwt(token) {
      try {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
        return JSON.parse(jsonPayload);
      } catch (e) {
        return null;
      }
    }

    window.onload = async () => {
      const token = localStorage.getItem('token');
      if (!token) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô');
        window.location.href = '/login/login.html';
        return;
      }

      const payload = parseJwt(token);
      if (!payload) {
        alert('Token ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        localStorage.removeItem('token');
        window.location.href = '/login/login.html';
        return;
      }

      // ‡πÇ‡∏´‡∏•‡∏î coin
      try {
        const res = await fetch('/api/coins/balance', {
          headers: { Authorization: `Bearer ${token}` },
        });
        const data = await res.json();
        if (res.ok && data.coin_balance !== undefined) {
          document.getElementById('balance').textContent = Number(data.coin_balance).toFixed(2);
        }
      } catch (err) {}

      // ‡πÇ‡∏´‡∏•‡∏î profile ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
      renderProfile(payload);

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° seller
      const sidebar = document.getElementById("sidebarMenu");
      if (payload.role === 'seller') {
        const btn = document.createElement("button");
        btn.dataset.page = "myProductSell";
        btn.textContent = "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢";
        sidebar.appendChild(btn);
      }

      // ‚úÖ ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ page ‡∏à‡∏≤‡∏Å URL ‡πÅ‡∏•‡πâ‡∏ß trigger click
      const urlParams = new URLSearchParams(window.location.search);
      const page = urlParams.get('page');
      if (page) {
        const targetBtn = [...document.querySelectorAll("#sidebarMenu button")].find(b => b.dataset.page === page);
        if (targetBtn) targetBtn.click();
      }
    };


    // sidebar click
    document.getElementById("sidebarMenu").addEventListener("click", (e) => {
      if (e.target.tagName === "BUTTON") {
        const page = e.target.dataset.page;
        const payload = parseJwt(localStorage.getItem('token'));

        if (page === "profile") {
          renderProfile(payload);  // ‚úÖ ‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà
        }
        if (page === "address") {
          document.getElementById("contentArea").innerHTML = `
            <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>
            <form id="addressForm" class="profile-form">
              <label>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
              <input type="text" id="full_name" disabled>

              <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
              <input type="text" id="phone" disabled>

              <label for="location">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡πà‡∏π‡∏à‡∏±‡∏î‡∏™‡πà‡∏á </label>
                  <input type="text" id="location" name="location" required>

                  <label for="District ">‡πÄ‡∏Ç‡∏ï / ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ </label>
                  <input type="text" id="District" name="District" required>

                  <label for="province">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î </label>
                  <select name="province" id="province">
                      <option value="">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</option>
                      <option value="‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà">‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà</option>
                      <option value="‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£">‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£</option>
                      <option value="‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ">‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå">‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå</option>
                      <option value="‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£">‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£</option>
                      <option value="‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô">‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô</option>
                      <option value="‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ">‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤">‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤</option>
                      <option value="‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ">‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó">‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó</option>
                      <option value="‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥">‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥</option>
                      <option value="‡∏ä‡∏∏‡∏°‡∏û‡∏£">‡∏ä‡∏∏‡∏°‡∏û‡∏£</option>
                      <option value="‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢">‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢</option>
                      <option value="‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà">‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà</option>
                      <option value="‡∏ï‡∏£‡∏±‡∏á">‡∏ï‡∏£‡∏±‡∏á</option>
                      <option value="‡∏ï‡∏£‡∏≤‡∏î">‡∏ï‡∏£‡∏≤‡∏î</option>
                      <option value="‡∏ï‡∏≤‡∏Å">‡∏ï‡∏≤‡∏Å</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å">‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°">‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°">‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤">‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä">‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä</option>
                      <option value="‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå">‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå</option>
                      <option value="‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ">‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™">‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™</option>
                      <option value="‡∏ô‡πà‡∏≤‡∏ô">‡∏ô‡πà‡∏≤‡∏ô</option>
                      <option value="‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨">‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨</option>
                      <option value="‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå">‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå</option>
                      <option value="‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ">‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ</option>
                      <option value="‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå">‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå</option>
                      <option value="‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ">‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ">‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ</option>
                      <option value="‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤">‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤</option>
                      <option value="‡∏û‡∏∞‡πÄ‡∏¢‡∏≤">‡∏û‡∏∞‡πÄ‡∏¢‡∏≤</option>
                      <option value="‡∏û‡∏±‡∏á‡∏á‡∏≤">‡∏û‡∏±‡∏á‡∏á‡∏≤</option>
                      <option value="‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á">‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á</option>
                      <option value="‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£">‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£</option>
                      <option value="‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å">‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å</option>
                      <option value="‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ">‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå">‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå</option>
                      <option value="‡πÅ‡∏û‡∏£‡πà">‡πÅ‡∏û‡∏£‡πà</option>
                      <option value="‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï">‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï</option>
                      <option value="‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°">‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°</option>
                      <option value="‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£">‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£</option>
                      <option value="‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô">‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô</option>
                      <option value="‡∏¢‡πÇ‡∏™‡∏ò‡∏£">‡∏¢‡πÇ‡∏™‡∏ò‡∏£</option>
                      <option value="‡∏¢‡∏∞‡∏•‡∏≤">‡∏¢‡∏∞‡∏•‡∏≤</option>
                      <option value="‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î">‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î</option>
                      <option value="‡∏£‡∏∞‡∏ô‡∏≠‡∏á">‡∏£‡∏∞‡∏ô‡∏≠‡∏á</option>
                      <option value="‡∏£‡∏∞‡∏¢‡∏≠‡∏á">‡∏£‡∏∞‡∏¢‡∏≠‡∏á</option>
                      <option value="‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ">‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ">‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏•‡∏≥‡∏õ‡∏≤‡∏á">‡∏•‡∏≥‡∏õ‡∏≤‡∏á</option>
                      <option value="‡∏•‡∏≥‡∏û‡∏π‡∏ô">‡∏•‡∏≥‡∏û‡∏π‡∏ô</option>
                      <option value="‡πÄ‡∏•‡∏¢">‡πÄ‡∏•‡∏¢</option>
                      <option value="‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©">‡∏®‡∏£‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©</option>
                      <option value="‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£">‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£</option>
                      <option value="‡∏™‡∏á‡∏Ç‡∏•‡∏≤">‡∏™‡∏á‡∏Ç‡∏•‡∏≤</option>
                      <option value="‡∏™‡∏ï‡∏π‡∏•">‡∏™‡∏ï‡∏π‡∏•</option>
                      <option value="‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£">‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£</option>
                      <option value="‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°">‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°</option>
                      <option value="‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£">‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£</option>
                      <option value="‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß">‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß</option>
                      <option value="‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ">‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ">‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢">‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢</option>
                      <option value="‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ">‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ</option>
                      <option value="‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ">‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ</option>
                      <option value="‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå">‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå</option>
                      <option value="‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢">‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢</option>
                      <option value="‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π">‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π</option>
                      <option value="‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á">‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á</option>
                      <option value="‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç">‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç</option>
                      <option value="‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ">‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</option>
                      <option value="‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå">‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå</option>
                      <option value="‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ">‡∏≠‡∏∏‡∏ó‡∏±‡∏¢‡∏ò‡∏≤‡∏ô‡∏µ</option>
                      <option value="‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ">‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ</option>
                  </select>

                  <label for="zip_code">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå </label>
                  <input type="text" id="zip_code" name="zip_code" required>

              <button type="submit" class="save-btn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </form>
            <p id="addressStatus"></p>
          `;

          const token = localStorage.getItem("token");

          // ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏î‡∏¥‡∏°
          fetch("/api/profile/address", {
            headers: { Authorization: "Bearer " + token },
          })
            .then((res) => res.json())
            .then((data) => {
              const status = document.getElementById("addressStatus");

              if (data.error) {
                status.innerText = data.error;
                status.style.color = "red";
                return;
              }

              // ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
              document.getElementById("full_name").value = data.full_name || "";
              document.getElementById("phone").value = data.phone || "";

              // ‚úÖ ‡πÅ‡∏¢‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• address ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ä‡πà‡∏≠‡∏á input
              if (data.address) {
                const parts = data.address.split(", ");
                document.getElementById("location").value = parts[0] || "";
                document.getElementById("District").value = parts[1] || "";
                document.getElementById("province").value = parts[2] || "";
                document.getElementById("zip_code").value = parts[3] || "";
              }

              status.innerText = "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úÖ";
              status.style.color = "green";
              
            })
            .catch((err) => {
              console.error(err);
              const status = document.getElementById("addressStatus");
              status.innerText = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
              status.style.color = "red";
            });

          // ‚úÖ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          document
            .getElementById("addressForm")
            .addEventListener("submit", (e) => {
              e.preventDefault();

              const location = document.getElementById("location").value.trim();
              const district = document.getElementById("District").value.trim();
              const province = document.getElementById("province").value.trim();
              const zip = document.getElementById("zip_code").value.trim();

              if (!location || !district || !province || !zip) {
                showAlertError("‚ùó ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á");
                return;
              }

              const address = `${location}, ${district}, ${province}, ${zip}`;
    
              fetch("/api/profile/address", {
                method: "PUT",
                headers: {
                  "Content-Type": "application/json",
                  Authorization: "Bearer " + token,
                },
                body: JSON.stringify({ address }),
              })
                .then((res) => res.json())
                .then((data) => {
                  showAlert("‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
                })
                .catch((err) => {
                  console.error(err);
                  showAlertError("‚ùó ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å");
                });
            });
        }


        if (page === "myProducts") {
          document.getElementById("contentArea").innerHTML = `<h2>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏â‡∏±‡∏ô‡∏ä‡∏ô‡∏∞</h2><div id="myProductsList">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>`;

          const token = localStorage.getItem('token');
          fetch('/api/profile', {
            headers: { 'Authorization': 'Bearer ' + token }
          })
            .then(res => res.json())
            .then(products => {
              const list = document.getElementById("myProductsList");
              if (!products.length) {
                list.innerHTML = "<p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞</p>";
                return;
              }
              list.innerHTML = products.map(p => `
              <div class="product-card">
                <img src="${p.images[0] || '../pic/default.png'}" class="product-img"/>
                <div class="product-details">
                  <h3>${p.name}</h3>
                  <p>${p.description || ''}</p>
                  <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: ${p.final_price} coins</p>
                  <small>‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏π‡∏•: ${new Date(p.closed_at).toLocaleString()}</small>
                </div>
              </div>
            `).join('');
            })
            .catch(err => {
              console.error(err);
              document.getElementById("myProductsList").innerHTML = "<p>‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>";
            });
        }if (page === "myProductSell") {
            document.getElementById("contentArea").innerHTML = `
              <h2 style="text-align:center;">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏â‡∏±‡∏ô‡∏Ç‡∏≤‡∏¢</h2>
              <div id="myProductSellList">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
            `;

            const token = localStorage.getItem('token');
            fetch('/api/profile/my-sell-products', {
              headers: { 'Authorization': 'Bearer ' + token }
            })
            .then(res => res.json())
            .then(products => {
              const list = document.getElementById("myProductSellList");
              if (!products.length) {
                list.innerHTML = "<p>‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>";
                return;
              }
              list.innerHTML = products.map(p => `
                <div class="product-card">
                  <img src="${p.images[0] || '../pic/default.png'}" class="product-img"/>
                  <div class="product-details">
                    <h3>${p.name}</h3>
                    <p>${p.description || ''}</p>
                    <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ${p.start_price} coins</p>
                    <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: ${p.final_price ? p.final_price + " coins" : "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞"}</p>
                    <p>‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞: ${p.winner_username || '-'}</p>
                    <small>‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏π‡∏•: ${p.closed_at ? new Date(p.closed_at).toLocaleString() : '-'}</small>
                    ${p.winner_name ? `
                      <button onclick="openModal('${p.winner_name}','${p.winner_phone}','${p.winner_address}')">
                        ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á
                      </button>
                    ` : ''}
                  </div>
                </div>
              `).join('');
            })
            .catch(err => {
              console.error(err);
              document.getElementById("myProductSellList").innerHTML = "<p>‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</p>";
            });
          }


        document.getElementById("sidebarMenu").classList.remove("active");
      }
    });
    function openModal(name, phone, address) {
      document.getElementById("modalName").innerText = name || '-';
      document.getElementById("modalPhone").innerText = phone || '-';
      document.getElementById("modalAddress").innerText = address || '-';
      document.getElementById("deliveryModal").style.display = "block";
    }

    function closeModal() {
      document.getElementById("deliveryModal").style.display = "none";
    }

    window.onclick = function(event) {
      const modal = document.getElementById("deliveryModal");
      if (event.target === modal) {
        closeModal();
      }
    }

  </script>

</body>

</html>